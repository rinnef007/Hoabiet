var language = [
    "100% chân thật và công bằng",
    "Tất cả các lần mở hộp đều 100% công bằng và được bảo vệ bởi công nghệ chứng minh tính công bằng hàng đầu trong ngành. Tất cả sản phẩm đều được mua từ StockX hoặc các nhà cung cấp chính thức. ",
    "Xem thêm",
    "Xem thêm",
    "Tổng số hộp đã mở",
    "Liên hệ với chúng tôi",
    "Câu hỏi thường gặp",
    "Điều khoản dịch vụ",
    "Tuyên bố quyền riêng tư",
    "Quy tắc nền tảng",
    "Phản hồi ý kiến",
    "Chính sách Cookie",
    "Chính sách chống rửa tiền",
    "",
    "Trang chủ",
    "Trò chơi",
    "ĐĂNG NHẬP",
    "Đăng ký",
    "Đặt lại mật khẩu",
    "Xác nhận",
    "Thị trường",
    "của tôi",
    "Đăng ký",
    "Vui lòng nhập mật khẩu",
    "Vui lòng nhập mật khẩu xác nhận",
    "Mật khẩu phải có ít nhất 6 ký tự",
    "Mật khẩu phải chứa cả chữ hoa và chữ thường",
    "Mật khẩu nhập không khớp",
    "Vui lòng nhập Email chính xác",
    "Quên mật khẩu?",
    "Vui lòng chọn đồng ý với điều khoản",
    "Đăng nhập thất bại:",
    "Chọn loại thanh toán",
    "Thanh toán",
    "Số tiền",
    "Khác",
    "Hơn 20 phương thức thanh toán",
    "ID người dùng:",
    "Hộp chưa xử lý",
    "Vàng của tôi",
    "Địa chỉ liên hệ",
    "Hàng tồn kho",
    "Lưu lượng giao dịch",
    "Cho đi",
    "Gửi hàng",
    "Phản hồi ý kiến",
    "Thoát",
    "Khung tìm kiếm",
    "Theo giá",
    "Theo chữ cái",
    "Ngày nhỏ nhấ",
    "Ngày lớn nhấ",
    "Lọc",
    "Hỗ trợ",
    "Ý kiến",
    "Đặt câu hỏi cho đội ngũ hỗ trợ của chúng tôi",
    "Ý kiến mới",
    "Tiêu đề",
    "Nội dung vấn đề",
    "Hình ảnh",
    "Tải lên tối đa 2Mb",
    "Gửi",
    "Sản phẩm",
    "Họ và tên",
    "Điện thoại",
    "Vui lòng nhập số điện thoại",
    "Email",
    "Địa chỉ chi tiết",
    "Tỉnh",
    "Vui lòng chọn tỉnh",
    "Thành phố",
    "Vui lòng chọn thành phố",
    "Quận/Huyện",
    "Vui lòng chọn quận/huyện",
    "Mã bưu điện",
    "Vui lòng nhập mã bưu điện",
    "Địa chỉ cụ thể",
    "Vui lòng nhập địa chỉ cụ thể",
    "Kích cỡ",
    "Kích cỡ giày",
    "Kích cỡ quần áo",
    "Lưu",
    "Quay lại",
    "Công bằng",
    "Mở hộp",
    "Mở hộp",
    "Mở hộp nhanh",
    "Trải nghiệm mở hộp",
    "Vật phẩm trong hộp",
    "Xác nhận",
    "Thanh toán thành công!",
    "Tiếp tục mở hộp",
    "Vật phẩm thu được",
    "Tất cả hộp",
    "Vui lòng nhập mật khẩu *",
    "Vui lòng nhập Email",
    "Vui lòng nhập biệt danh *",
    "Vui lòng nhập Email *",
    "Xác nhận mật khẩu *",
    "Tôi muốn nhận các chương trình khuyến mãi có giá trị qua email",
    " Đánh dấu ô này để đăng ký trang web, người dùng tuyên bố đã đọc, hiểu và chấp nhận các điều khoản chung. Khi đánh dấu vào ô này, người dùng tuyên bố đã đủ 18 tuổi",
    "Vui lòng nhập biệt danh",
    "Email đã được gửi thành công, vui lòng hoàn tất xác minh",
    "Mở hộp tốt nhất",
    "Mở hộp gần đây",
    "Thông tin liên hệ",
    "Nếu gặp vấn đề kết nối, vui lòng liên hệ qua",
    "Liên hệ đội ngũ hỗ trợ 24/7 của chúng tôi, họ sẽ trả lời bạn trong vòng 24 giờ tới",
    "Tư vấn kinh doanh và các câu hỏi khác:",
    "Số điện thoại liên hệ:",
    "Thông tin công ty:",
    "Vui lòng chọn thành phố",
    "Vui lòng chọn quận/huyện",
    "Vui lòng chọn tỉnh",
    "Vui lòng chọn tỉnh",
    "Vui lòng nhập ID của người chuyển nhượng",
    "ID",
    "Thời gian",
    "Loại",
    "Số tiền",
    "Trạng thái",
    "Mua hộp mù",
    "Thanh toán nạp tiền",
    "Hoàn tiền",
    "nhà tài trợ",
    "Giá hộp mù",
    "Thao tác thành công",
    "Không thể thanh toán",
    "Kho hàng",
    "ID người dùng không chính xác",
    "Tiếp tục",
    "người cho",
    "Giá hộp mù",
    "chuyển khoản",
    "đang tiến hành",
    "đã kết thúc ",
    "Chỉ có thể tải lên tối đa hai hình ảnh",
    "Nạp tiền thủ công",
    "Chi tiết sản phẩm",
    "Phone",
    "Vui lòng nhập Phone *",
    "Vui lòng nhập CAPTCHA  *",
    "Gửi",
    "Checkcode không chính xác",
    "Vui lòng nhập mã kiểm tra *"
];
var APIURL = "https://mgboxadm.com";
// var APIURL = "https://neadmcs.boxecs.com";
// var SocketUrl = "wss://mgboxadm.com/ws";
// 封装公共请求方法
async function sendRequest(method, url, data, headers, successCallback, errorCallback) {
    method = method || "POST";
    data = data || {};
    headers = headers || {};
    if (!localStorage.getItem('langCode')) {
        localStorage.setItem("langCode", "vi")

    }
    // 后端的公钥
    const publicKey = await fetchPublicKey();
    if (!data || Object.keys(data).length === 0) {
        // alert('请输入要加密的数据');
        // return;
    }


    const encrypt = new JSEncrypt();
    encrypt.setPublicKey(publicKey);
    const encryptedData = encrypt.encrypt(data);

    if (!encryptedData) {
        alert('加密失败：请检查公钥格式是否正确');
        if (typeof errorCallback === "function") {
            errorCallback(null, null, "加密失败");
        }
        return;
    } 
    console.log('-----',data,encryptedData)
    // 添加 langCode 到 headers
    headers["langCode"] = localStorage.getItem('langCode');
    // 发送加密后的数据到后端
    fetch(url, {
        method: method,
        headers: {
            'Content-Type': 'application/json',
            ...headers
        },
        body: JSON.stringify({ encryptedData: encryptedData })
    })
        .then(response => response.json())
        .then(data => {
            // console.log('后端返回:', data);
            if (typeof successCallback === "function") {
                successCallback(data);
                try {
                    langPage(localStorage.getItem('langCode'));
                }catch (e){
                    console.error(e)
                }
            }
        })
        .catch(error => {
            console.error('请求错误:', error);
            if (typeof errorCallback === "function") {
                errorCallback(error);
            }
        });
}

function fetchPublicKey() {
    const publicKeyUrl = 'https://gebocrt.oss-ap-southeast-7.aliyuncs.com/hgoiauh/cer.text';

    return fetch(publicKeyUrl)
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.text();
        })
        .catch(error => {
            console.error('Failed to fetch public key:', error);
            return `-----BEGIN PUBLIC KEY-----
MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA0ggNnv/Q4ctH3NV9jrIs
DlBaGW8dzy0kB/CrNNrc0TNqgkgjfQp0g/2qKKV+21OW8fUxGRbYkZezAyQ1ZuBI
br1346Wak3w9EBHhZ0/cBXofC/FxlE9bu0IMFpD+sg29J6pnXaXdjsibQ0TLSebm
ghAjWBRYKvQNE66p0IiT22NlEOUBemRUdUaAt5wjKyuBZbDfMy68sDekq4Lb1N1u
4DAFTbsCRtTMJ9CS5P72VKRrUXB0c15KzNQohZjL9T/4lMbay4aHQdsW9Vp2KhFh
wBZhTXnwL4UjVn835I+2x5hQ6bh5kBV++fjb9ULN2gM4GhH7fR0LtHsu8TuLxjn4
cDdzhO/+QLV+/KD6tdnOwk7QDEEOtYoquvaysXRFMQeboboq/6qwK3hMym/gK5P8
62+2PfyObtCgG8xS/rTAFqIIn81CNdfy5K+Z64DXH8XWhiH4BmgxOKd/uDft6+pN
X/Wmsi22UOo9oMYsgcCC5cse2MMEb/4Q49uapgOBIzLhtPWUoMh2MyTdkjfExRPH
SVTU8MK0RHTni8qE9cNEYm4U92vnR5FazUk6viEzPq3RJPdKsBYuBX6/r0jJg/7R
gs88+FhlogNU4nTecB/FS9JzLYFR4Ufg2qhh9+JkyMv/WUjF6TSXcp0ImA8iIARr
kIkzuZSNHWjMki2ivcBW+lcCAwEAAQ==
-----END PUBLIC KEY-----`;
            // throw error; // 抛出错误以便外部处理
        });
}
